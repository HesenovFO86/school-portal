<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Школьный портал</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    input, select, button {
      display: block;
      width: 100%;
      padding: 10px;
      margin-top: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #0057d0;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
</head>
<body>
  <div class="container">
    <h2 id="title">Школьный портал</h2>
    <input type="text" id="username" placeholder="Имя">
    <input type="password" id="password" placeholder="Пароль">
    <button id="loginBtn">Войти</button>
    <select id="language">
      <option value="ru">Русский</option>
      <option value="en">English</option>
      <option value="az">Azərbaycanca</option>
    </select>
  </div>

  <script>
    // Firebase config (замени на свой при необходимости)
    const firebaseConfig = {
      apiKey: "AIzaSyDSU7JH_P1IVtyn_yWGZTk8VVT4TkEk76M",
      authDomain: "school-portal-5e058.firebaseapp.com",
      projectId: "school-portal-5e058",
      storageBucket: "school-portal-5e058.appspot.com",
      messagingSenderId: "2880581785937",
      appId: "1:2880581785937:web:13b88ee9549bc8c96695f0"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const elements = {
      title: document.getElementById("title"),
      username: document.getElementById("username"),
      password: document.getElementById("password"),
      loginBtn: document.getElementById("loginBtn"),
      language: document.getElementById("language")
    };

    const translations = {
      ru: {
        title: "Школьный портал",
        username: "Имя",
        password: "Пароль",
        login: "Войти",
        error: "Неверное имя или пароль!",
        welcome: "Добро пожаловать"
      },
      en: {
        title: "School Portal",
        username: "Username",
        password: "Password",
        login: "Login",
        error: "Invalid name or password!",
        welcome: "Welcome"
      },
      az: {
        title: "Məktəb Portalı",
        username: "Ad",
        password: "Şifrə",
        login: "Daxil ol",
        error: "Yanlış ad və ya şifrə!",
        welcome: "Xoş gəlmisiniz"
      }
    };

    function applyLanguage(lang) {
      const t = translations[lang];
      elements.title.textContent = t.title;
      elements.username.placeholder = t.username;
      elements.password.placeholder = t.password;
      elements.loginBtn.textContent = t.login;
    }

    elements.language.addEventListener("change", () => {
      applyLanguage(elements.language.value);
    });

    applyLanguage("ru"); // default

    elements.loginBtn.addEventListener("click", async () => {
      const name = elements.username.value.trim();
      const pass = elements.password.value.trim();
      const lang = elements.language.value;
      const t = translations[lang];

      if (!name || !pass) {
        alert(t.error);
        return;
      }

      try {
        const doc = await db.collection("accessCodes").doc(name).get();
        if (!doc.exists) {
          alert(t.error);
          return;
        }

        const data = doc.data();
        if (data.password === pass) {
          alert(`${t.welcome}: ${name} (${data.role})`);
        } else {
          alert(t.error);
        }
      } catch (e) {
        alert("Ошибка подключения к базе.");
        console.error(e);
      }
    });
  </script>
</body>
</html>
